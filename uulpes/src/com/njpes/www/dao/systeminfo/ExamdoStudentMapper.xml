<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.njpes.www.dao.systeminfo.ExamdoStudentMapper">
	<resultMap id="BaseResultMap" type="com.njpes.www.entity.systeminfo.ExamdoStudent">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		<id column="id" property="id" jdbcType="BIGINT" />
		<id column="bj" property="bj" jdbcType="BIGINT" />
		<result column="user_id" property="userId" jdbcType="BIGINT" />
		<result column="xm" property="xm" jdbcType="VARCHAR" />
		<result column="csrq" property="csrq" jdbcType="VARCHAR" />
		<result column="xh" property="xh" jdbcType="VARCHAR" />
		<result column="scale_id" property="scaleId" jdbcType="INTEGER" />
		<result column="lo_time" property="loTime" jdbcType="TIMESTAMP" />
		<result column="hi_time" property="hiTime" jdbcType="TIMESTAMP" />
		<result column="ok_time" property="okTime" jdbcType="TIMESTAMP" />
		<result column="flag" property="flag" jdbcType="TINYINT" />
		<result column="taskid" property="taskid" jdbcType="BIGINT" />
		<result column="xmpy" property="xmpy" jdbcType="VARCHAR" />
		<result column="xbm" property="xbm" jdbcType="CHAR" />
		<result column="xxmc" property="xxmc" jdbcType="VARCHAR" />
		<result column="orgid" property="orgid" jdbcType="BIGINT" />
		<result column="gradeid" property="gradeid" jdbcType="INTEGER" />
		<result column="nj" property="nj" jdbcType="BIGINT" />
		<result column="njmc" property="njmc" jdbcType="VARCHAR" />
		<result column="bjmc" property="bjmc" jdbcType="VARCHAR" />
		<result column="countyid" property="countyid" jdbcType="VARCHAR" />
		<result column="cityid" property="cityid" jdbcType="VARCHAR" />
		<result column="xd" property="xd" jdbcType="VARCHAR" />
		<result column="parentvisible" property="parentvisible"
			jdbcType="TINYINT" />
		<result column="teachervisible" property="teachervisible"
			jdbcType="TINYINT" />
		<result column="studentvisible" property="studentvisible"
			jdbcType="TINYINT" />
		<result column="warnvisible" property="warnvisible" jdbcType="INTEGER" />
		<result column="testlimit" property="testlimit" jdbcType="TINYINT" />
		<result column="ifmh" property="ifmh" />
		<result column="statusflag" property="statusflag" />
	</resultMap>
	<resultMap id="ResultMapWithBLOBs" type="com.njpes.www.entity.systeminfo.ExamdoStudent"
		extends="BaseResultMap">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		<result column="attrs" property="attrs" jdbcType="LONGVARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		id, bj, user_id, xm, csrq, xh, scale_id, lo_time, hi_time, ok_time,
		flag, taskid,
		xmpy, xbm, xxmc, orgid, gradeid, nj, njmc, bjmc,
		countyid, cityid, xd,
		parentvisible,
		teachervisible, studentvisible,
		warnvisible, testlimit,ifmh,statusflag
	</sql>
	<sql id="Blob_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		attrs
	</sql>
	<select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs"
		parameterType="com.njpes.www.entity.systeminfo.ExamdoStudentKey">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		select
		<include refid="Base_Column_List" />
		,
		<include refid="Blob_Column_List" />
		from examdo_student
		where id = #{id,jdbcType=BIGINT}
		and bj =
		#{bj,jdbcType=BIGINT}
	</select>
	<select id="queryExamdoStudentsByClassId" parameterType="Map"
		resultType="Map">
		select distinct es.user_id,
		s.xm,s.xh,s.sfzjh,s.xbm,es.njmc,es.bjmc from
		examdo_student es
		left join
		student s on es.user_id=s.id
		where es.bj=#{classid} and
		es.orgid=#{orgid} and es.scale_id=#{scaleid} and
		es.ok_time is null
	</select>
	<select id="queryExamdoStudentsByGradeId" parameterType="Map"
		resultType="Map">
		select distinct es.user_id,
		s.xm,s.xh,s.sfzjh,s.xbm,es.njmc,es.bjmc from
		examdo_student es
		left join
		student s on es.user_id=s.id
		where es.gradeid=#{gradeid} and
		es.orgid=#{orgid} and
		es.scale_id=#{scaleid} and es.ok_time is null
	</select>
	<delete id="deleteByPrimaryKey" parameterType="com.njpes.www.entity.systeminfo.ExamdoStudentKey">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		delete from examdo_student
		where id = #{id,jdbcType=BIGINT}
		and bj =
		#{bj,jdbcType=BIGINT}
	</delete>
	<insert id="insert" parameterType="com.njpes.www.entity.systeminfo.ExamdoStudent">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		insert into examdo_student (id, bj, user_id,
		xm, csrq, xh, scale_id,
		lo_time, hi_time, ok_time,
		flag, taskid, xmpy,
		xbm, xxmc, orgid,
		gradeid,
		nj, njmc, bjmc, countyid,
		cityid, xd, parentvisible,
		teachervisible, studentvisible, warnvisible,
		testlimit, attrs)
		values
		(#{id,jdbcType=BIGINT}, #{bj,jdbcType=BIGINT},
		#{userId,jdbcType=BIGINT},
		#{xm,jdbcType=VARCHAR},
		#{csrq,jdbcType=VARCHAR}, #{xh,jdbcType=VARCHAR},
		#{scaleId,jdbcType=INTEGER},
		#{loTime,jdbcType=TIMESTAMP},
		#{hiTime,jdbcType=TIMESTAMP}, #{okTime,jdbcType=TIMESTAMP},
		#{flag,jdbcType=TINYINT}, #{taskid,jdbcType=BIGINT},
		#{xmpy,jdbcType=VARCHAR},
		#{xbm,jdbcType=CHAR},
		#{xxmc,jdbcType=VARCHAR}, #{orgid,jdbcType=BIGINT},
		#{gradeid,jdbcType=INTEGER},
		#{nj,jdbcType=BIGINT},
		#{njmc,jdbcType=VARCHAR}, #{bjmc,jdbcType=VARCHAR},
		#{countyid,jdbcType=VARCHAR},
		#{cityid,jdbcType=VARCHAR},
		#{xd,jdbcType=VARCHAR}, #{parentvisible,jdbcType=TINYINT},
		#{teachervisible,jdbcType=TINYINT},
		#{studentvisible,jdbcType=TINYINT}, #{warnvisible,jdbcType=INTEGER},
		#{testlimit,jdbcType=TINYINT}, #{attrs,jdbcType=LONGVARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.njpes.www.entity.systeminfo.ExamdoStudent">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		insert into examdo_student
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="bj != null">
				bj,
			</if>
			<if test="userId != null">
				user_id,
			</if>
			<if test="xm != null">
				xm,
			</if>
			<if test="csrq != null">
				csrq,
			</if>
			<if test="xh != null">
				xh,
			</if>
			<if test="scaleId != null">
				scale_id,
			</if>
			<if test="loTime != null">
				lo_time,
			</if>
			<if test="hiTime != null">
				hi_time,
			</if>
			<if test="okTime != null">
				ok_time,
			</if>
			<if test="flag != null">
				flag,
			</if>
			<if test="taskid != null">
				taskid,
			</if>
			<if test="xmpy != null">
				xmpy,
			</if>
			<if test="xbm != null">
				xbm,
			</if>
			<if test="xxmc != null">
				xxmc,
			</if>
			<if test="orgid != null">
				orgid,
			</if>
			<if test="gradeid != null">
				gradeid,
			</if>
			<if test="nj != null">
				nj,
			</if>
			<if test="njmc != null">
				njmc,
			</if>
			<if test="bjmc != null">
				bjmc,
			</if>
			<if test="countyid != null">
				countyid,
			</if>
			<if test="cityid != null">
				cityid,
			</if>
			<if test="xd != null">
				xd,
			</if>
			<if test="parentvisible != null">
				parentvisible,
			</if>
			<if test="teachervisible != null">
				teachervisible,
			</if>
			<if test="studentvisible != null">
				studentvisible,
			</if>
			<if test="warnvisible != null">
				warnvisible,
			</if>
			<if test="testlimit != null">
				testlimit,
			</if>
			<if test="attrs != null">
				attrs,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=BIGINT},
			</if>
			<if test="bj != null">
				#{bj,jdbcType=BIGINT},
			</if>
			<if test="userId != null">
				#{userId,jdbcType=BIGINT},
			</if>
			<if test="xm != null">
				#{xm,jdbcType=VARCHAR},
			</if>
			<if test="csrq != null">
				#{csrq,jdbcType=VARCHAR},
			</if>
			<if test="xh != null">
				#{xh,jdbcType=VARCHAR},
			</if>
			<if test="scaleId != null">
				#{scaleId,jdbcType=INTEGER},
			</if>
			<if test="loTime != null">
				#{loTime,jdbcType=TIMESTAMP},
			</if>
			<if test="hiTime != null">
				#{hiTime,jdbcType=TIMESTAMP},
			</if>
			<if test="okTime != null">
				#{okTime,jdbcType=TIMESTAMP},
			</if>
			<if test="flag != null">
				#{flag,jdbcType=TINYINT},
			</if>
			<if test="taskid != null">
				#{taskid,jdbcType=BIGINT},
			</if>
			<if test="xmpy != null">
				#{xmpy,jdbcType=VARCHAR},
			</if>
			<if test="xbm != null">
				#{xbm,jdbcType=CHAR},
			</if>
			<if test="xxmc != null">
				#{xxmc,jdbcType=VARCHAR},
			</if>
			<if test="orgid != null">
				#{orgid,jdbcType=BIGINT},
			</if>
			<if test="gradeid != null">
				#{gradeid,jdbcType=INTEGER},
			</if>
			<if test="nj != null">
				#{nj,jdbcType=BIGINT},
			</if>
			<if test="njmc != null">
				#{njmc,jdbcType=VARCHAR},
			</if>
			<if test="bjmc != null">
				#{bjmc,jdbcType=VARCHAR},
			</if>
			<if test="countyid != null">
				#{countyid,jdbcType=VARCHAR},
			</if>
			<if test="cityid != null">
				#{cityid,jdbcType=VARCHAR},
			</if>
			<if test="xd != null">
				#{xd,jdbcType=VARCHAR},
			</if>
			<if test="parentvisible != null">
				#{parentvisible,jdbcType=TINYINT},
			</if>
			<if test="teachervisible != null">
				#{teachervisible,jdbcType=TINYINT},
			</if>
			<if test="studentvisible != null">
				#{studentvisible,jdbcType=TINYINT},
			</if>
			<if test="warnvisible != null">
				#{warnvisible,jdbcType=INTEGER},
			</if>
			<if test="testlimit != null">
				#{testlimit,jdbcType=TINYINT},
			</if>
			<if test="attrs != null">
				#{attrs,jdbcType=LONGVARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.njpes.www.entity.systeminfo.ExamdoStudent">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		update examdo_student
		<set>
			<if test="userId != null">
				user_id = #{userId,jdbcType=BIGINT},
			</if>
			<if test="xm != null">
				xm = #{xm,jdbcType=VARCHAR},
			</if>
			<if test="csrq != null">
				csrq = #{csrq,jdbcType=VARCHAR},
			</if>
			<if test="xh != null">
				xh = #{xh,jdbcType=VARCHAR},
			</if>
			<if test="scaleId != null">
				scale_id = #{scaleId,jdbcType=INTEGER},
			</if>
			<if test="loTime != null">
				lo_time = #{loTime,jdbcType=TIMESTAMP},
			</if>
			<if test="hiTime != null">
				hi_time = #{hiTime,jdbcType=TIMESTAMP},
			</if>
			<if test="okTime != null">
				ok_time = #{okTime,jdbcType=TIMESTAMP},
			</if>
			<if test="flag != null">
				flag = #{flag,jdbcType=TINYINT},
			</if>
			<if test="taskid != null">
				taskid = #{taskid,jdbcType=BIGINT},
			</if>
			<if test="xmpy != null">
				xmpy = #{xmpy,jdbcType=VARCHAR},
			</if>
			<if test="xbm != null">
				xbm = #{xbm,jdbcType=CHAR},
			</if>
			<if test="xxmc != null">
				xxmc = #{xxmc,jdbcType=VARCHAR},
			</if>
			<if test="orgid != null">
				orgid = #{orgid,jdbcType=BIGINT},
			</if>
			<if test="gradeid != null">
				gradeid = #{gradeid,jdbcType=INTEGER},
			</if>
			<if test="nj != null">
				nj = #{nj,jdbcType=BIGINT},
			</if>
			<if test="njmc != null">
				njmc = #{njmc,jdbcType=VARCHAR},
			</if>
			<if test="bjmc != null">
				bjmc = #{bjmc,jdbcType=VARCHAR},
			</if>
			<if test="countyid != null">
				countyid = #{countyid,jdbcType=VARCHAR},
			</if>
			<if test="cityid != null">
				cityid = #{cityid,jdbcType=VARCHAR},
			</if>
			<if test="xd != null">
				xd = #{xd,jdbcType=VARCHAR},
			</if>
			<if test="parentvisible != null">
				parentvisible = #{parentvisible,jdbcType=TINYINT},
			</if>
			<if test="teachervisible != null">
				teachervisible = #{teachervisible,jdbcType=TINYINT},
			</if>
			<if test="studentvisible != null">
				studentvisible = #{studentvisible,jdbcType=TINYINT},
			</if>
			<if test="warnvisible != null">
				warnvisible = #{warnvisible,jdbcType=INTEGER},
			</if>
			<if test="testlimit != null">
				testlimit = #{testlimit,jdbcType=TINYINT},
			</if>
			<if test="attrs != null">
				attrs = #{attrs,jdbcType=LONGVARCHAR},
			</if>
		</set>
		where id = #{id,jdbcType=BIGINT}
		and bj = #{bj,jdbcType=BIGINT}
	</update>
	<update id="updateByPrimaryKeyWithBLOBs" parameterType="com.njpes.www.entity.systeminfo.ExamdoStudent">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		update examdo_student
		set user_id = #{userId,jdbcType=BIGINT},
		xm =
		#{xm,jdbcType=VARCHAR},
		csrq = #{csrq,jdbcType=VARCHAR},
		xh =
		#{xh,jdbcType=VARCHAR},
		scale_id = #{scaleId,jdbcType=INTEGER},
		lo_time
		= #{loTime,jdbcType=TIMESTAMP},
		hi_time = #{hiTime,jdbcType=TIMESTAMP},
		ok_time = #{okTime,jdbcType=TIMESTAMP},
		flag =
		#{flag,jdbcType=TINYINT},
		taskid = #{taskid,jdbcType=BIGINT},
		xmpy =
		#{xmpy,jdbcType=VARCHAR},
		xbm = #{xbm,jdbcType=CHAR},
		xxmc =
		#{xxmc,jdbcType=VARCHAR},
		orgid = #{orgid,jdbcType=BIGINT},
		gradeid =
		#{gradeid,jdbcType=INTEGER},
		nj = #{nj,jdbcType=BIGINT},
		njmc =
		#{njmc,jdbcType=VARCHAR},
		bjmc = #{bjmc,jdbcType=VARCHAR},
		countyid =
		#{countyid,jdbcType=VARCHAR},
		cityid = #{cityid,jdbcType=VARCHAR},
		xd =
		#{xd,jdbcType=VARCHAR},
		parentvisible =
		#{parentvisible,jdbcType=TINYINT},
		teachervisible =
		#{teachervisible,jdbcType=TINYINT},
		studentvisible =
		#{studentvisible,jdbcType=TINYINT},
		warnvisible =
		#{warnvisible,jdbcType=INTEGER},
		testlimit =
		#{testlimit,jdbcType=TINYINT},
		attrs = #{attrs,jdbcType=LONGVARCHAR}
		where id = #{id,jdbcType=BIGINT}
		and bj = #{bj,jdbcType=BIGINT}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.njpes.www.entity.systeminfo.ExamdoStudent">
		<!-- WARNING - @mbggenerated This element is automatically generated by
			MyBatis Generator, do not modify. This element was generated on Sat Nov 21
			17:06:55 CST 2015. -->
		update examdo_student
		set user_id = #{userId,jdbcType=BIGINT},
		xm =
		#{xm,jdbcType=VARCHAR},
		csrq = #{csrq,jdbcType=VARCHAR},
		xh =
		#{xh,jdbcType=VARCHAR},
		scale_id = #{scaleId,jdbcType=INTEGER},
		lo_time
		= #{loTime,jdbcType=TIMESTAMP},
		hi_time = #{hiTime,jdbcType=TIMESTAMP},
		ok_time = #{okTime,jdbcType=TIMESTAMP},
		flag =
		#{flag,jdbcType=TINYINT},
		taskid = #{taskid,jdbcType=BIGINT},
		xmpy =
		#{xmpy,jdbcType=VARCHAR},
		xbm = #{xbm,jdbcType=CHAR},
		xxmc =
		#{xxmc,jdbcType=VARCHAR},
		orgid = #{orgid,jdbcType=BIGINT},
		gradeid =
		#{gradeid,jdbcType=INTEGER},
		nj = #{nj,jdbcType=BIGINT},
		njmc =
		#{njmc,jdbcType=VARCHAR},
		bjmc = #{bjmc,jdbcType=VARCHAR},
		countyid =
		#{countyid,jdbcType=VARCHAR},
		cityid = #{cityid,jdbcType=VARCHAR},
		xd =
		#{xd,jdbcType=VARCHAR},
		parentvisible =
		#{parentvisible,jdbcType=TINYINT},
		teachervisible =
		#{teachervisible,jdbcType=TINYINT},
		studentvisible =
		#{studentvisible,jdbcType=TINYINT},
		warnvisible =
		#{warnvisible,jdbcType=INTEGER},
		testlimit =
		#{testlimit,jdbcType=TINYINT}
		where id = #{id,jdbcType=BIGINT}
		and bj =
		#{bj,jdbcType=BIGINT}
	</update>

	<select id="selectEntityByPage" resultMap="BaseResultMap">
		select
		eds.id, eds.bj, eds.user_id, s.xm, eds.csrq,
		eds.xh,eds.scale_id, eds.lo_time, eds.hi_time, eds.ok_time, eds.flag,
		eds.taskid,
		eds.xmpy, eds.xbm, eds.xxmc, eds.orgid, eds.gradeid,
		eds.nj, eds.njmc,
		eds.bjmc, eds.countyid, eds.cityid, eds.xd,
		eds.parentvisible,
		eds.teachervisible, eds.studentvisible,
		eds.warnvisible,
		eds.testlimit,ifmh,statusflag
		from examdo_student eds
		join student s on
		eds.user_id=s.id
		<where>
			1=1


			<if test="examdoStudent.userId != null">
				and user_id = #{examdoStudent.userId,jdbcType=BIGINT}
			</if>
			<if test="beginDate != null">
				and lo_time &gt; #{beginDate,jdbcType=TIMESTAMP}
			</if>
			<if test="endDate != null">
				and hi_time &lt; #{endDate,jdbcType=TIMESTAMP}
			</if>
		</where>
		order by id desc
	</select>
	<update id="resetExamdo" parameterType="java.lang.Long">
		update examdo_student set
		ok_time=null,statusflag=0 where id=#{id};
	</update>
	<update id="resetExamdoBatch">
		update examdo_student set ok_time=null,statusflag=0 where id in
		<foreach collection="array" index="index" item="item" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</update>
	<update id="resetExamdoMh" parameterType="java.lang.Long">
		update
		examdo_mental_health set ok_time_s=null,ok_time_t=null,ok_time_p=null
		where result_id=#{id};
	</update>
	<update id="resetExamdoMhBatch">
		update examdo_mental_health set
		ok_time_s=null,ok_time_t=null,ok_time_p=null where result_id in
		<foreach collection="array" index="index" item="item" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</update>
</mapper>