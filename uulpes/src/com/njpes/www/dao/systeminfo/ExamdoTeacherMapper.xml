<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.njpes.www.dao.systeminfo.ExamdoTeacherMapper" >
  <resultMap id="BaseResultMap" type="com.njpes.www.entity.systeminfo.ExamdoTeacher" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="user_id" property="userId" jdbcType="BIGINT" />
    <result column="xm" property="xm" jdbcType="VARCHAR" />
    <result column="scale_id" property="scaleId" jdbcType="INTEGER" />
    <result column="lo_time" property="loTime" jdbcType="TIMESTAMP" />
    <result column="hi_time" property="hiTime" jdbcType="TIMESTAMP" />
    <result column="ok_time" property="okTime" jdbcType="TIMESTAMP" />
    <result column="flag" property="flag" jdbcType="TINYINT" />
    <result column="taskid" property="taskid" jdbcType="BIGINT" />
    <result column="roleid" property="roleid" jdbcType="INTEGER" />
    <result column="cityid" property="cityid" jdbcType="VARCHAR" />
    <result column="countyid" property="countyid" jdbcType="VARCHAR" />
    <result column="orgid" property="orgid" jdbcType="BIGINT" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    id, user_id,xm, scale_id, lo_time, hi_time, ok_time, flag, taskid, roleid, cityid, countyid, 
    orgid
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from examdo_teacher
    where id = #{id,jdbcType=BIGINT}
  </select>
  <select id="queryExamdoTeachersByRoleId" parameterType="Map" resultType="Map">
      select distinct et.user_id, t.xm,t.sfzjh,t.xbm,r.role_name rolename from examdo_teacher et 
      left join teacher t on et.user_id=t.id 
      left join role r on r.id = et.roleid
      where et.orgid=#{orgid}
      <if test="roleid!=-1">
       and et.roleid=#{roleid} 
       </if>
       and et.scale_id=#{scaleid} and et.ok_time is null
  </select>
  
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    delete from examdo_teacher
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.njpes.www.entity.systeminfo.ExamdoTeacher" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    insert into examdo_teacher (id, user_id, scale_id, 
      lo_time, hi_time, ok_time, 
      flag, taskid, roleid, 
      cityid, countyid, orgid
      )
    values (#{id,jdbcType=BIGINT}, #{userId,jdbcType=BIGINT}, #{scaleId,jdbcType=INTEGER}, 
      #{loTime,jdbcType=TIMESTAMP}, #{hiTime,jdbcType=TIMESTAMP}, #{okTime,jdbcType=TIMESTAMP}, 
      #{flag,jdbcType=TINYINT}, #{taskid,jdbcType=BIGINT}, #{roleid,jdbcType=INTEGER}, 
      #{cityid,jdbcType=VARCHAR}, #{countyid,jdbcType=VARCHAR}, #{orgid,jdbcType=BIGINT}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.njpes.www.entity.systeminfo.ExamdoTeacher" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    insert into examdo_teacher
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="scaleId != null" >
        scale_id,
      </if>
      <if test="loTime != null" >
        lo_time,
      </if>
      <if test="hiTime != null" >
        hi_time,
      </if>
      <if test="okTime != null" >
        ok_time,
      </if>
      <if test="flag != null" >
        flag,
      </if>
      <if test="taskid != null" >
        taskid,
      </if>
      <if test="roleid != null" >
        roleid,
      </if>
      <if test="cityid != null" >
        cityid,
      </if>
      <if test="countyid != null" >
        countyid,
      </if>
      <if test="orgid != null" >
        orgid,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=BIGINT},
      </if>
      <if test="scaleId != null" >
        #{scaleId,jdbcType=INTEGER},
      </if>
      <if test="loTime != null" >
        #{loTime,jdbcType=TIMESTAMP},
      </if>
      <if test="hiTime != null" >
        #{hiTime,jdbcType=TIMESTAMP},
      </if>
      <if test="okTime != null" >
        #{okTime,jdbcType=TIMESTAMP},
      </if>
      <if test="flag != null" >
        #{flag,jdbcType=TINYINT},
      </if>
      <if test="taskid != null" >
        #{taskid,jdbcType=BIGINT},
      </if>
      <if test="roleid != null" >
        #{roleid,jdbcType=INTEGER},
      </if>
      <if test="cityid != null" >
        #{cityid,jdbcType=VARCHAR},
      </if>
      <if test="countyid != null" >
        #{countyid,jdbcType=VARCHAR},
      </if>
      <if test="orgid != null" >
        #{orgid,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.njpes.www.entity.systeminfo.ExamdoTeacher" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    update examdo_teacher
    <set >
      <if test="userId != null" >
        user_id = #{userId,jdbcType=BIGINT},
      </if>
      <if test="scaleId != null" >
        scale_id = #{scaleId,jdbcType=INTEGER},
      </if>
      <if test="loTime != null" >
        lo_time = #{loTime,jdbcType=TIMESTAMP},
      </if>
      <if test="hiTime != null" >
        hi_time = #{hiTime,jdbcType=TIMESTAMP},
      </if>
      <if test="okTime != null" >
        ok_time = #{okTime,jdbcType=TIMESTAMP},
      </if>
      <if test="flag != null" >
        flag = #{flag,jdbcType=TINYINT},
      </if>
      <if test="taskid != null" >
        taskid = #{taskid,jdbcType=BIGINT},
      </if>
      <if test="roleid != null" >
        roleid = #{roleid,jdbcType=INTEGER},
      </if>
      <if test="cityid != null" >
        cityid = #{cityid,jdbcType=VARCHAR},
      </if>
      <if test="countyid != null" >
        countyid = #{countyid,jdbcType=VARCHAR},
      </if>
      <if test="orgid != null" >
        orgid = #{orgid,jdbcType=BIGINT},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.njpes.www.entity.systeminfo.ExamdoTeacher" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Nov 21 17:07:15 CST 2015.
    -->
    update examdo_teacher
    set user_id = #{userId,jdbcType=BIGINT},
      scale_id = #{scaleId,jdbcType=INTEGER},
      lo_time = #{loTime,jdbcType=TIMESTAMP},
      hi_time = #{hiTime,jdbcType=TIMESTAMP},
      ok_time = #{okTime,jdbcType=TIMESTAMP},
      flag = #{flag,jdbcType=TINYINT},
      taskid = #{taskid,jdbcType=BIGINT},
      roleid = #{roleid,jdbcType=INTEGER},
      cityid = #{cityid,jdbcType=VARCHAR},
      countyid = #{countyid,jdbcType=VARCHAR},
      orgid = #{orgid,jdbcType=BIGINT}
    where id = #{id,jdbcType=BIGINT}
  </update>
   <select id="selectEntityByPage" resultMap="BaseResultMap">
		select
		edt.id, edt.user_id,t.xm, edt.scale_id, edt.lo_time, edt.hi_time, edt.ok_time, edt.flag, edt.taskid, edt.roleid, edt.cityid, edt.countyid, edt.orgid
		from examdo_teacher edt
		join teacher t on edt.user_id=t.id
		<where>
			1=1
		
			
			<if test="examdoTeacher.userId != null">
				and user_id = #{examdoTeacher.userId,jdbcType=BIGINT}
			</if>
			<if test="beginDate != null">
				and lo_time &gt; #{beginDate,jdbcType=TIMESTAMP}
			</if>
			<if test="endDate != null">
				and lo_time &lt; #{endDate,jdbcType=TIMESTAMP}
			</if>
		</where>
		order by id desc
	</select>
	<update id="resetExamdo" parameterType="java.lang.Long">
	    update examdo_teacher set ok_time=null where id=#{id};
	</update>
</mapper>