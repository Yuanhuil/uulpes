<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.njpes.www.dao.assessmentcenter.ExamdoMapper" >
  <resultMap id="BaseResultMap" type="com.njpes.www.entity.assessmentcenter.Examdo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    <id column="ex_user_id" property="userId" jdbcType="BIGINT" />
    <id column="ex_scale_id" property="scaleId" jdbcType="INTEGER" />
    <result column="ex_lo_time" property="loTime" jdbcType="TIMESTAMP" />
    <result column="ex_hi_time" property="hiTime" jdbcType="TIMESTAMP" />
    <result column="ex_ok_time" property="okTime" jdbcType="TIMESTAMP" />
    <result column="ex_flag" property="flag" jdbcType="TINYINT" />
    <result column="title" property="scalename" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="StudentExamdo" type="com.njpes.www.entity.scaletoollib.ExamdoStudent" >
    <id column="taskid" property="taskid"/>
    <id column="id" property="resultid" />
    <id column="user_id" property="userid" />
    <id column="orgid" property="orgid"/>
    <result column="scale_id" property="scaleid" />
    <result column="xxmc" property="xxmc"  />
    <result column="xm" property="xm" />
    <result column="csrq" property="csrq"/>
    <result column="xmpy" property="xmpy" />
    <result column="xbm" property="xbm" />
    <result column="sfzjh" property="sfzjh"  />
    <result column="xh" property="xh"  />
    <result column="xd" property="xd"  />
    <result column="gradeid" property="gradeid"/>
    <result column="nj" property="nj"/>
    <result column="bj" property="bj"  />
    <result column="njmc" property="njmc" />
    <result column="bjmc" property="bjmc"/>
    <result column="questionnum" property="questionnum" />
    <result column="ok_time" property="oktime"/>
    <result column="studentvisible" property="studentvisible" />
    <result column="teachervisible" property="teachervisible" />
    <result column="parentvisible" property="parentvisible" />
    <result column="normid" property="normid" />
    <result column="attrs" property="attrs"  />
    <result column="ifmh" property="ifmh"  />
    <result column="statusflag" property="statusflag"  />
  </resultMap>
   <resultMap id="TeacherExamdo" type="com.njpes.www.entity.scaletoollib.ExamdoTeacher" >
    <id column="taskid" property="taskid"/>
    <id column="id" property="resultid" />
    <id column="user_id" property="userid" />
    <id column="orgid" property="orgid"/>
    <result column="scale_id" property="scaleid" />
    <result column="xxmc" property="xxmc"  />
    <result column="xm" property="xm" />
    <result column="csrq" property="csrq"/>
    <result column="xmpy" property="xmpy" />
    <result column="xbm" property="xbm" />
    <result column="sfzjh" property="sfzjh"  />
    <result column="roleid" property="roleid"/>
    <result column="rolename" property="rolename"/>
    <result column="qustionnum" property="qustionnum" />
    <result column="ok_time" property="oktime"/>
    <result column="attrs" property="attrs"  />
    <result column="normid" property="normid" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    ex.user_id ex_user_id, ex.scale_id ex_scale_id, ex.lo_time ex_lo_time, ex.hi_time ex_hi_time, ex.ok_time ex_ok_time, ex.flag ex_flag 
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="com.njpes.www.entity.assessmentcenter.ExamdoKey" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />,
    <include refid="com.njpes.www.dao.baseinfo.AccountMapper.Base_Column_List" />
    from examdo_student ex
    where user_id = #{userId,jdbcType=BIGINT}
      and scale_id = #{scaleId,jdbcType=INTEGER}
  </select>
  
  <select id="selectByUserId" resultMap="BaseResultMap" parameterType="Map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    ,title
    from ${table} ex
    join scale s on ex.scale_id=s.code 
    where user_id = #{userId,jdbcType=BIGINT}
    	and ok_time is null
  </select>
  <select id="selectStudentExamdoByResultId" resultMap="StudentExamdo" parameterType="java.lang.Long" >
    select taskid,id,orgid,user_id,scale_id,xxmc,xd,gradeid,realgradeid,nj,bj,njmc,bjmc,ok_time,statusflag,normid
    from examdo_student ex 
    where id = #{resultid,jdbcType=BIGINT}
  </select>
  <select id="selectTeacherExamdoByResultId" resultMap="TeacherExamdo" parameterType="java.lang.Long" >
    select taskid,id,orgid,user_id,roleid,scale_id,ok_time,normid
    from examdo_teacher ex 
    where id = #{resultid,jdbcType=BIGINT}
  </select>
<select id="selectStudentExamdoByStudentId" resultMap="StudentExamdo" parameterType="Map" >
    select taskid,id,orgid,user_id,scale_id,xxmc,xd,gradeid,nj,bj,njmc,bjmc,ok_time,ifmh,statusflag,normid
    from examdo_student es 
    where es.user_id = #{studentid,jdbcType=BIGINT} and es.scale_id=#{scaleid} and es.ok_time is null 
    and TIMESTAMPDIFF(DAY,es.hi_time,now()) &lt; 90
  </select>
  <select id="selectTeacherExamdoByTeacherId" resultMap="TeacherExamdo" parameterType="Map" >
    select taskid,id,orgid,user_id,scale_id,roleid,ok_time,normid
    from examdo_teacher et 
    where et.user_id = #{teacherid,jdbcType=BIGINT} and et.ok_time is null 
    and TIMESTAMPDIFF(DAY,hi_time,now()) &lt; 90
  </select>
  
  <select id="queryStudentExamdo" resultMap = "StudentExamdo" >
      select es.id resultid,es.taskid,es.scale_id scaleid,es.user_id userid,es.ok_time,es.studentvisible,es.teachervisible,es.parentvisible,s.sfzjh,
      sc.title scalename,sc.questionnum, gc.title njmc,es.nj,es.bj,c.bjmc,s.xm 
      from examdo_student es 
        join student s on es.user_id = s.id 
		join class c on es.bj = c.id 
		join scale sc on sc.code= es.scale_id
		join gradecode gc on gc.id = es.gradeid
		join scaletype st on st.id = sc.typeid
		where 
		ok_time is null and es.orgid=#{dmgFilterParam.orgid}
		<if test="dmgFilterParam.bj!= null and dmgFilterParam.bj!= -1" >
		    and es.bj = #{dmgFilterParam.bj}
		</if>
		<if test="dmgFilterParam.nj != null and dmgFilterParam.nj != '-1'.toString()" >
		    and es.gradeid = #{dmgFilterParam.nj}
		</if>
		<if test="dmgFilterParam.scaleType != null and dmgFilterParam.scaleType != '-1'.toString()" >
		    and st.id = #{dmgFilterParam.scaleType}
		</if>
		<if test="dmgFilterParam.scaleName != null and dmgFilterParam.scaleName != '-1'.toString()" >
		    and sc.title = #{dmgFilterParam.scaleName}
		</if>
		<if test="dmgFilterParam.scaleId != null and dmgFilterParam.scaleId != '-1'.toString()" >
		    and sc.code = #{dmgFilterParam.scaleId}
		</if>
		<if test="dmgFilterParam.name != null and dmgFilterParam.name!=''" >
		    and s.xm = #{dmgFilterParam.name}
		</if>
		<if test="dmgFilterParam.identify != null and dmgFilterParam.identify!=''" >
		    and s.sfzjh = #{dmgFilterParam.identify}
		</if>
		<if test="dmgFilterParam.gender != null and dmgFilterParam.gender != '-1'.toString()" >
		    and s.xbm = #{dmgFilterParam.gender}
		</if>
		Order By es.lo_time Desc
  </select>
  <select id="queryStudentExamdoByPage" resultMap = "StudentExamdo" >
      select es.id resultid,es.taskid,es.scale_id scaleid,es.user_id userid,es.ok_time,es.studentvisible,es.teachervisible,es.parentvisible,es.normid,es.ifmh,es.statusflag,s.sfzjh,
      sc.title scalename,sc.questionnum, gc.title njmc,es.nj,es.bj,c.bjmc,s.xm,s.xbm
      from examdo_student es 
        join student s on es.user_id = s.id 
		join class c on es.bj = c.id 
		join scale sc on sc.code= es.scale_id
		join gradecode gc on gc.id = es.gradeid
		join scaletype st on st.id = sc.typeid
		where ((ifmh=0 and statusflag=0) or (ifmh=1 and statusflag &lt; 7))
		and es.orgid=#{dmgFilterParam.orgid} and CURRENT_TIMESTAMP BETWEEN es.lo_time and es.hi_time
		<if test="dmgFilterParam.bj!= null and dmgFilterParam.bj!= -1" >
		    and es.bj = #{dmgFilterParam.bj}
		</if>
		<if test="dmgFilterParam.nj != null and dmgFilterParam.nj != '-1'.toString()" >
		    and es.gradeid = #{dmgFilterParam.nj}
		</if>
		<if test="dmgFilterParam.scaleType != null and dmgFilterParam.scaleType != '-1'.toString()" >
		    and st.id = #{dmgFilterParam.scaleType}
		</if>
		<if test="dmgFilterParam.scaleName != null and dmgFilterParam.scaleName != '-1'.toString()" >
		    and sc.title = #{dmgFilterParam.scaleName}
		</if>
		<if test="dmgFilterParam.scaleId != null and dmgFilterParam.scaleId != '-1'.toString()" >
		    and sc.code = #{dmgFilterParam.scaleId}
		</if>
		<if test="dmgFilterParam.name != null and dmgFilterParam.name!=''" >
		    and s.xm = #{dmgFilterParam.name}
		</if>
		<if test="dmgFilterParam.identify != null and dmgFilterParam.identify!=''" >
		    and s.sfzjh = #{dmgFilterParam.identify}
		</if>
		<if test="dmgFilterParam.gender != null and dmgFilterParam.gender != '-1'.toString()" >
		    and s.xbm = #{dmgFilterParam.gender}
		</if>
		Order By es.lo_time Desc
  </select>
  <select id="queryTeacherExamdo" resultMap = "TeacherExamdo">
      select es.id resultid,es.taskid,es.scale_id scaleid,es.roleid,r.role_name rolename,es.user_id userid,es.ok_time,s.sfzjh,
      sc.title scalename,sc.questionnum,s.xm 
      from examdo_teacher es 
        join teacher s on es.user_id = s.id  
		join scale sc on sc.code= es.scale_id
		join scaletype st on st.id = sc.typeid
		join role r on r.id=es.roleid
		where 
		ok_time is null and es.orgid=#{dmgFilterParam.orgid}
		<if test="dmgFilterParam.teacherRole!= null and dmgFilterParam.teacherRole!= -1" >
		    and es.roleid = #{dmgFilterParam.teacherRole}
		</if>
		<if test="dmgFilterParam.scaleType != null and dmgFilterParam.scaleType != '-1'.toString()" >
		    and st.id = #{dmgFilterParam.scaleType}
		</if>
		<if test="dmgFilterParam.scaleName != null and dmgFilterParam.scaleName != '-1'.toString()" >
		    and sc.title = #{dmgFilterParam.scaleName}
		</if>
		<if test="dmgFilterParam.scaleId != null and dmgFilterParam.scaleId != '-1'.toString()" >
		    and sc.code = #{dmgFilterParam.scaleId}
		</if>
		<if test="dmgFilterParam.name != null and dmgFilterParam.name!=''" >
		    and s.xm = #{dmgFilterParam.name}
		</if>
		<if test="dmgFilterParam.identify != null and dmgFilterParam.identify!=''" >
		    and s.sfzjh = #{dmgFilterParam.identify}
		</if>
		<if test="dmgFilterParam.gender != null and dmgFilterParam.gender != '-1'.toString()" >
		    and s.xbm = #{dmgFilterParam.gender}
		</if>
		Order By es.lo_time Desc
  </select>
  <select id="queryTeacherExamdoByPage" resultMap = "TeacherExamdo">
      select es.id resultid,es.taskid,es.scale_id scaleid,es.roleid,r.role_name rolename,es.user_id userid,es.ok_time,es.normid,s.sfzjh,
      sc.title scalename,sc.questionnum,s.xm,s.xbm
      from examdo_teacher es 
        join teacher s on es.user_id = s.id  
		join scale sc on sc.code= es.scale_id
		join scaletype st on st.id = sc.typeid
		join role r on r.id=es.roleid
		where 
		ok_time is null and es.orgid=#{dmgFilterParam.orgid} and CURRENT_TIMESTAMP BETWEEN es.lo_time and es.hi_time
		<if test="dmgFilterParam.teacherRole!= null and dmgFilterParam.teacherRole!= -1" >
		    and es.roleid = #{dmgFilterParam.teacherRole}
		</if>
		<if test="dmgFilterParam.scaleType != null and dmgFilterParam.scaleType != '-1'.toString()" >
		    and st.id = #{dmgFilterParam.scaleType}
		</if>
		<if test="dmgFilterParam.scaleName != null and dmgFilterParam.scaleName != '-1'.toString()" >
		    and sc.title = #{dmgFilterParam.scaleName}
		</if>
		<if test="dmgFilterParam.scaleId != null and dmgFilterParam.scaleId != '-1'.toString()" >
		    and sc.code = #{dmgFilterParam.scaleId}
		</if>
		<if test="dmgFilterParam.name != null and dmgFilterParam.name!=''" >
		    and s.xm = #{dmgFilterParam.name}
		</if>
		<if test="dmgFilterParam.identify != null and dmgFilterParam.identify!=''" >
		    and s.sfzjh = #{dmgFilterParam.identify}
		</if>
		<if test="dmgFilterParam.gender != null and dmgFilterParam.gender != '-1'.toString()" >
		    and s.xbm = #{dmgFilterParam.gender}
		</if>
		Order By es.lo_time Desc
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="com.njpes.www.entity.assessmentcenter.ExamdoKey" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    delete from examdo_student ex
    where user_id = #{userId,jdbcType=BIGINT}
      and scale_id = #{scaleId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.njpes.www.entity.assessmentcenter.Examdo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    insert into examdo_student (user_id, scale_id, lo_time, 
      hi_time, ok_time, flag
      )
    values (#{userId,jdbcType=BIGINT}, #{scaleId,jdbcType=INTEGER}, #{loTime,jdbcType=TIMESTAMP}, 
      #{hiTime,jdbcType=TIMESTAMP}, #{okTime,jdbcType=TIMESTAMP}, #{flag,jdbcType=TINYINT}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.njpes.www.entity.assessmentcenter.Examdo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    insert into examdo_student
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="userId != null" >
        user_id,
      </if>
      <if test="scaleId != null" >
        scale_id,
      </if>
      <if test="loTime != null" >
        lo_time,
      </if>
      <if test="hiTime != null" >
        hi_time,
      </if>
      <if test="okTime != null" >
        ok_time,
      </if>
      <if test="flag != null" >
        flag,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="userId != null" >
        #{userId,jdbcType=BIGINT},
      </if>
      <if test="scaleId != null" >
        #{scaleId,jdbcType=INTEGER},
      </if>
      <if test="loTime != null" >
        #{loTime,jdbcType=TIMESTAMP},
      </if>
      <if test="hiTime != null" >
        #{hiTime,jdbcType=TIMESTAMP},
      </if>
      <if test="okTime != null" >
        #{okTime,jdbcType=TIMESTAMP},
      </if>
      <if test="flag != null" >
        #{flag,jdbcType=TINYINT},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.njpes.www.entity.assessmentcenter.Examdo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    update examdo_student
    <set >
      <if test="loTime != null" >
        lo_time = #{loTime,jdbcType=TIMESTAMP},
      </if>
      <if test="hiTime != null" >
        hi_time = #{hiTime,jdbcType=TIMESTAMP},
      </if>
      <if test="okTime != null" >
        ok_time = #{okTime,jdbcType=TIMESTAMP},
      </if>
      <if test="flag != null" >
        flag = #{flag,jdbcType=TINYINT},
      </if>
    </set>
    where user_id = #{userId,jdbcType=BIGINT}
      and scale_id = #{scaleId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.njpes.www.entity.assessmentcenter.Examdo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun May 17 15:42:20 CST 2015.
    -->
    update examdo_student
    set lo_time = #{loTime,jdbcType=TIMESTAMP},
      hi_time = #{hiTime,jdbcType=TIMESTAMP},
      ok_time = #{okTime,jdbcType=TIMESTAMP},
      flag = #{flag,jdbcType=TINYINT}
    where user_id = #{userId,jdbcType=BIGINT}
      and scale_id = #{scaleId,jdbcType=INTEGER}
  </update>
  <update id="setStudentOkTime" parameterType="Map">
      update examdo_student 
      set ok_time = #{okTime,jdbcType=TIMESTAMP},statusflag=#{statusflag}
      where id = #{resultid}
      
  </update>
  <update id="setTeacherOkTime" parameterType="Map">
      update examdo_teacher 
      set ok_time = #{okTime,jdbcType=TIMESTAMP}
      where id = #{resultid}
      
  </update>
  <select id="queryStudentDistinctScales" resultType="edutec.scale.model.Scale">
		select distinct es.scale_id id,sc.title shortname  from examdo_student es,scale sc where es.scale_id=sc.code and orgid=#{org.id} and ok_time is null
  </select>
  <select id="queryTeacherDistinctScales" resultType="edutec.scale.model.Scale">
		select distinct es.scale_id id,sc.title shortname  from examdo_teacher es,scale sc where es.scale_id=sc.code and orgid=#{org.id} and ok_time is null
  </select>
  
  <select id="selectDistinctScaleAcorStype" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_student es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id} and sc.typeid=#{typeid} and ok_time is null
		<if test='gradeid != null and gradeid != "-1"' >
		    and es.gradeid=#{gradeid}
		</if>
		<if test='bjid != null and bjid != "-1"'>
		    and es.bj=#{bjid}
		</if>
  </select>
  <select id="selectDistinctScaleBySource" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_student es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id} and sc.source=#{sourceid} and ok_time is null
		<if test='gradeid != null and gradeid != "-1"' >
		    and es.gradeid=#{gradeid}
		</if>
		<if test='bjid != null and bjid != "-1"' >
		    and es.bj=#{bjid}
		</if>
  </select>
  <select id="selectDistinctScales" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_student es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id}  and ok_time is null
		<if test='gradeid != null and gradeid != "-1"' >
		    and es.gradeid=#{gradeid}
		</if>
		<if test='bjid != null and bjid != "-1"' >
		    and es.bj=#{bjid}
		</if>
		<if test='typeid != null and typeid != -1' >
		    and sc.typeid=#{typeid}
		</if>
		<if test='sourceid != null and sourceid != -1' >
		    and sc.source=#{sourceid}
		</if>
  </select>
  <select id="selectTchDistinctScaleAcorStype" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_teacher es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id} and sc.typeid=#{typeid} and ok_time is null
		<if test='roleid != null and roleid != "-1"' >
		    and es.roleid=#{roleid}
		</if>
  </select>
  <select id="selectTchDistinctScaleBySource" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_teacher es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id} and sc.source=#{sourceid} and ok_time is null
		<if test='roleid != null and roleid != "-1"' >
		    and es.roleid=#{roleid}
		</if>
  </select>
  <select id="selectTchDistinctScales" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_teacher es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id}  and ok_time is null
		<if test='roleid != null and roleid != "-1"' >
		    and es.roleid=#{roleid}
		</if>
		<if test='typeid != null and typeid != -1' >
		    and sc.typeid=#{typeid}
		</if>
		<if test='sourceid != null and sourceid != -1' >
		    and sc.source=#{sourceid}
		</if>
  </select>
   <select id="selectDistinctScaleByRoleId" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_teacher es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id} and ok_time is null
		<if test='roleid != null and roleid != "-1"' >
		    and es.roleid=#{roleid}
		</if>
  </select>
     <select id="selectDistinctScaleByGradeId" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
		select distinct es.scale_id id,sc.title shortname  from examdo_student es,scale sc 
		where es.scale_id=sc.code and orgid=#{org.id} and ok_time is null
		<if test='gradeid != null and gradeid != "-1"' >
		    and es.gradeid=#{gradeid}
		</if>
		<if test='bjid != null and bjid != "-1"' >
		    and es.bj=#{bjid}
		</if>
  </select>
  <select id="selectStudentDistinctQuxian" resultType="com.njpes.www.entity.baseinfo.District">
      select distinct es.countyid code,ar.name from examdo_student es 
      left join newarea ar on ar.code = es.countyid 
      where es.statusflag>0
  </select>
   <select id="selectTeacherDistinctQuxian" resultType="com.njpes.www.entity.baseinfo.District">
      select distinct es.countyid code,ar.name from examdo_teacher es 
      left join newarea ar on ar.code = es.countyid 
      where es.ok_time is not null
  </select>
  <select id="selectStudentDistinctSonSchool" resultType="com.njpes.www.entity.baseinfo.organization.Organization">
      select distinct es.orgid id,og.name from examdo_student es 
      left join organization og on og.id = es.orgid 
      where og.org_level = 4 and og.org_type=2 and es.statusflag>0
  </select>
  <select id="selectTeacherDistinctSonSchool" resultType="com.njpes.www.entity.baseinfo.organization.Organization">
      select distinct es.orgid id,og.name from examdo_teacher es 
      left join organization og on og.id = es.orgid 
      where og.org_level = 4 and og.org_type=2 and es.ok_time is not null
  </select>
  <select id="getStudentDistinctGradeInCounty" resultType="com.njpes.www.entity.baseinfo.organization.Grade">
      select distinct es.gradeid,es.njmc from examdo_student es 
       left join organization og on og.id = es.orgid 
      where es.countyid=#{countyid} and og.org_level = 6 and og.org_type=2 and es.statusflag>0
  </select>
  <select id="getStudentDistinctGradeInSchool" resultType="com.njpes.www.entity.baseinfo.organization.Grade">
      select distinct es.gradeid,es.njmc from examdo_student es 
      where es.orgid=#{schoolid} and es.statusflag>0
  </select>
 <select id="getTeacherDistinctRoleInCounty" resultType="com.njpes.www.entity.baseinfo.Role">
      select distinct es.roleid,es.rolename from examdo_teacher es 
      where es.orgid=#{schoolid} and es.ok_time is not null
  </select>
  <select id="getStudentDistinctScaleInCounty" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
      select distinct es.scale_id code,sc.title, sc.typeid scaletype,sc.source scalesource from examdo_student es 
       left join organization og on og.id = es.orgid 
       left join scale sc on sc.code = es.scale_id 
      where  es.countyid=#{countyid} and og.org_level = 6 and og.org_type=2 and es.statusflag>0
  </select>
  <select id="getStudentDistinctScaleInSchool" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
	  select distinct es.scale_id code,sc.title, sc.typeid scaletype,sc.source scalesource from examdo_student es 
	  left join scale sc on sc.code = es.scale_id 
	  <if  test='gradeid != null and gradeid != "-1"' >
          and es.gradeid=#{gradeid}
      </if>
      where es.orgid=#{schoolid} and es.statusflag>0
  </select>
  <select id="getTeacherDistinctScaleInCounty" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
      select distinct es.scale_id code,sc.title, sc.typeid scaletype,sc.source scalesource from examdo_teacher es 
      where  es.orgid=#{schoolid}  and es.statusflag>0
  </select>
  <select id="getStudentDistinctScaleInCountyByGrade" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
      select distinct es.scale_id code,sc.title, sc.typeid scaletype,sc.source scalesource from examdo_student es 
        left join organization og on og.id = es.orgid 
       left join scale sc on sc.code = es.scale_id 
      where  es.countyid=#{countyid} 
      <if  test='gradeid != null and gradeid != "-1"' >
          and es.gradeid=#{gradeid}
      </if>
       and og.org_level = 6 and og.org_type=2 and es.statusflag>0
  </select>
  <select id="getTeacherDistinctScaleInCountyByRole" resultType="com.njpes.www.entity.scaletoollib.ScaleInfo">
      select distinct es.scale_id code,sc.title, sc.typeid scaletype,sc.source scalesource from examdo_teacher es 
       left join organization og on og.id = es.orgid 
       left join scale sc on sc.code = es.scale_id 
      where  es.countyid=#{countyid} 
      <if  test='roleid != null and roleid != "-1"' >
          and es.roleid=#{roleid}
      </if>
       and og.org_level = 6 and og.org_type=2 and es.statusflag>0

  </select>
</mapper>