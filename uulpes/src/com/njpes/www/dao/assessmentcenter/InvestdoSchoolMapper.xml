<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.njpes.www.dao.assessmentcenter.InvestdoSchoolMapper" >
  <resultMap id="BaseResultMap" type="com.njpes.www.entity.assessmentcenter.InvestdoSchool" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="taskid" property="taskid" jdbcType="BIGINT" />
    <result column="orgid" property="orgid" jdbcType="BIGINT" />
    <result column="scaleid" property="scaleid" jdbcType="INTEGER" />
    <result column="starttime" property="starttime" jdbcType="TIMESTAMP" />
    <result column="endtime" property="endtime" jdbcType="TIMESTAMP" />
    <result column="oktime" property="oktime" jdbcType="TIMESTAMP" />
    <result column="objecttype" property="objecttype" jdbcType="INTEGER" />
    <result column="roleid" property="roleid" jdbcType="INTEGER" />
    <result column="bjid" property="bjid" jdbcType="BIGINT" />
    <result column="gradeid" property="gradeid" jdbcType="INTEGER" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    id, taskid, orgid, scaleid, starttime, endtime, oktime, objecttype, roleid, bjid, 
    gradeid
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    select 
    <include refid="Base_Column_List" />
    from investdo_school
    where id = #{id,jdbcType=BIGINT}
  </select>
  <select id="getInvestdoByPage"  resultType="com.njpes.www.entity.assessmentcenter.MyInvesttask">
      select ivs.id,ivs.taskid,ivs.scaleid,it.name taskname,it.createtime,ie.name scalename,ivs.starttime,ivs.endtime ,itu.id resultid,ivs.roleid from investdo_school ivs
      left join  investtask it on ivs.taskid=it.id
      left join invest_exam ie on ie.id = it.scaleid
      left join invest_task_user itu on itu.taskid=ivs.taskid and itu.userid=#{investDispatcherFilterParam.userid} 
      where ivs.orgid=#{investDispatcherFilterParam.orgid}
      <if test="investDispatcherFilterParam.bjid!=-1">
       and ivs.bjid = #{investDispatcherFilterParam.bjid} 
      </if>
       <if test="investDispatcherFilterParam.roleidList!=null">
           and ivs.roleid in (select role_id from auth au where au.user_id=#{investDispatcherFilterParam.userid})
      </if>
  
			<if test="investDispatcherFilterParam.testStartTime!='' and investDispatcherFilterParam.testStartTime!=null">
				and it.starttime <![CDATA[
		  < 
		    ]]>
				#{investDispatcherFilterParam.testStartTime}
			</if>
			<if test="investDispatcherFilterParam.testEndTime!='' and investDispatcherFilterParam.testEndTime!=null">
				and it.endtime <![CDATA[
		  > 
		    ]]>
				#{investDispatcherFilterParam.testEndTime}
			</if>	
			<if test="investDispatcherFilterParam.taskKeywords!='' and investDispatcherFilterParam.taskKeywords!=null">
				and it.name like '%${investDispatcherFilterParam.taskKeywords}%'
			</if>
			<if test='investDispatcherFilterParam.progressStatus=="1"'>
				and ivs.starttime <![CDATA[> ]]> now()
			</if>
			<if test='investDispatcherFilterParam.progressStatus=="2"'>
				and ivs.starttime <![CDATA[< ]]> now() and a.endtime<![CDATA[> ]]> now()
			</if>
			<if test='investDispatcherFilterParam.progressStatus=="3"'>
				and ivs.endtime <![CDATA[< ]]> now()
			</if>
  </select>
  <select id="getInvestdoById" parameterType="java.lang.String" resultType="com.njpes.www.entity.assessmentcenter.MyInvesttask">
      
  </select>
  <!-- <select id="getStudentInvestdoByPage"  resultType="com.njpes.www.entity.assessmentcenter.MyInvesttask">
      select * from investdo_school ivs
      left join  investtask it on ivs.taskid=it.id
      left join invest_exam ie on ie.id = it.scaleid
      where ivs.orgid = #{investDispatcherFilterParam.orgid} and ivs.roleid=#{investDispatcherFilterParam.roleid} 
        <if test="investDispatcherFilterParam.dispatchTimeStart!='' and investDispatcherFilterParam.dispatchTimeStart!=null">
				and it.createtime<![CDATA[
		  >
		    ]]>#{investDispatcherFilterParam.dispatchTimeStart}
			</if>
			<if test="investDispatcherFilterParam.dispatchTimeEnd!='' and investDispatcherFilterParam.dispatchTimeEnd!=null">
				and it.createtime<![CDATA[
		  <
		    ]]>#{investDispatcherFilterParam.dispatchTimeEnd}
			</if>
			<if test="investDispatcherFilterParam.testStartTime!='' and investDispatcherFilterParam.testStartTime!=null">
				and it.starttime <![CDATA[
		  < 
		    ]]>
				#{investDispatcherFilterParam.testStartTime}
			</if>
			<if test="investDispatcherFilterParam.testEndTime!='' and investDispatcherFilterParam.testEndTime!=null">
				and it.endtime <![CDATA[
		  > 
		    ]]>
				#{investDispatcherFilterParam.testEndTime}
			</if>
			
  </select>-->
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    delete from investdo_school
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <delete id="deleteByTaskid">
      delete from investdo_school
    where taskid = #{taskid,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.njpes.www.entity.assessmentcenter.InvestdoSchool" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    insert into investdo_school (id, taskid, orgid, 
      scaleid, starttime, endtime, 
      oktime, objecttype, roleid, 
      bjid, gradeid)
    values (#{id,jdbcType=BIGINT}, #{taskid,jdbcType=BIGINT}, #{orgid,jdbcType=BIGINT}, 
      #{scaleid,jdbcType=INTEGER}, #{starttime,jdbcType=TIMESTAMP}, #{endtime,jdbcType=TIMESTAMP}, 
      #{oktime,jdbcType=TIMESTAMP}, #{objecttype,jdbcType=INTEGER}, #{roleid,jdbcType=INTEGER}, 
      #{bjid,jdbcType=BIGINT}, #{gradeid,jdbcType=INTEGER})
  </insert>
  <insert id="insertBatch" parameterType="com.njpes.www.entity.assessmentcenter.InvestdoSchool" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    insert into investdo_school (id, taskid, orgid, 
      scaleid, starttime, endtime, 
      oktime, objecttype, roleid, 
      bjid, gradeid)
    values 
    <foreach collection="list" item="item" index="index" separator="," >  
      (#{item.id,jdbcType=BIGINT}, #{item.taskid,jdbcType=BIGINT}, #{item.orgid,jdbcType=BIGINT}, 
      #{item.scaleid,jdbcType=INTEGER}, #{item.starttime,jdbcType=TIMESTAMP}, #{item.endtime,jdbcType=TIMESTAMP}, 
      #{item.oktime,jdbcType=TIMESTAMP}, #{item.objecttype,jdbcType=INTEGER}, #{item.roleid,jdbcType=INTEGER}, 
      #{item.bjid,jdbcType=BIGINT}, #{item.gradeid,jdbcType=INTEGER})
      </foreach>
  </insert>
  <insert id="insertSelective" parameterType="com.njpes.www.entity.assessmentcenter.InvestdoSchool" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    insert into investdo_school
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="taskid != null" >
        taskid,
      </if>
      <if test="orgid != null" >
        orgid,
      </if>
      <if test="scaleid != null" >
        scaleid,
      </if>
      <if test="starttime != null" >
        starttime,
      </if>
      <if test="endtime != null" >
        endtime,
      </if>
      <if test="oktime != null" >
        oktime,
      </if>
      <if test="objecttype != null" >
        objecttype,
      </if>
      <if test="roleid != null" >
        roleid,
      </if>
      <if test="bjid != null" >
        bjid,
      </if>
      <if test="gradeid != null" >
        gradeid,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="taskid != null" >
        #{taskid,jdbcType=BIGINT},
      </if>
      <if test="orgid != null" >
        #{orgid,jdbcType=BIGINT},
      </if>
      <if test="scaleid != null" >
        #{scaleid,jdbcType=INTEGER},
      </if>
      <if test="starttime != null" >
        #{starttime,jdbcType=TIMESTAMP},
      </if>
      <if test="endtime != null" >
        #{endtime,jdbcType=TIMESTAMP},
      </if>
      <if test="oktime != null" >
        #{oktime,jdbcType=TIMESTAMP},
      </if>
      <if test="objecttype != null" >
        #{objecttype,jdbcType=INTEGER},
      </if>
      <if test="roleid != null" >
        #{roleid,jdbcType=INTEGER},
      </if>
      <if test="bjid != null" >
        #{bjid,jdbcType=BIGINT},
      </if>
      <if test="gradeid != null" >
        #{gradeid,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.njpes.www.entity.assessmentcenter.InvestdoSchool" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    update investdo_school
    <set >
      <if test="taskid != null" >
        taskid = #{taskid,jdbcType=BIGINT},
      </if>
      <if test="orgid != null" >
        orgid = #{orgid,jdbcType=BIGINT},
      </if>
      <if test="scaleid != null" >
        scaleid = #{scaleid,jdbcType=INTEGER},
      </if>
      <if test="starttime != null" >
        starttime = #{starttime,jdbcType=TIMESTAMP},
      </if>
      <if test="endtime != null" >
        endtime = #{endtime,jdbcType=TIMESTAMP},
      </if>
      <if test="oktime != null" >
        oktime = #{oktime,jdbcType=TIMESTAMP},
      </if>
      <if test="objecttype != null" >
        objecttype = #{objecttype,jdbcType=INTEGER},
      </if>
      <if test="roleid != null" >
        roleid = #{roleid,jdbcType=INTEGER},
      </if>
      <if test="bjid != null" >
        bjid = #{bjid,jdbcType=BIGINT},
      </if>
      <if test="gradeid != null" >
        gradeid = #{gradeid,jdbcType=INTEGER},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.njpes.www.entity.assessmentcenter.InvestdoSchool" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Dec 27 21:07:13 CST 2015.
    -->
    update investdo_school
    set taskid = #{taskid,jdbcType=BIGINT},
      orgid = #{orgid,jdbcType=BIGINT},
      scaleid = #{scaleid,jdbcType=INTEGER},
      starttime = #{starttime,jdbcType=TIMESTAMP},
      endtime = #{endtime,jdbcType=TIMESTAMP},
      oktime = #{oktime,jdbcType=TIMESTAMP},
      objecttype = #{objecttype,jdbcType=INTEGER},
      roleid = #{roleid,jdbcType=INTEGER},
      bjid = #{bjid,jdbcType=BIGINT},
      gradeid = #{gradeid,jdbcType=INTEGER}
    where id = #{id,jdbcType=BIGINT}
  </update>
</mapper>