<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.njpes.www.dao.assessmentcenter.ExamdoMentalHealthMapper">
  <resultMap id="BaseResultMap" type="com.njpes.www.entity.assessmentcenter.ExamdoMentalHealth">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    <id column="result_id" jdbcType="BIGINT" property="resultId" />
    <result column="student_id" jdbcType="BIGINT" property="studentId" />
    <result column="parent_id" jdbcType="BIGINT" property="parentId" />
    <result column="teacher_id" jdbcType="BIGINT" property="teacherId" />
    <result column="lo_time" jdbcType="TIMESTAMP" property="loTime" />
    <result column="hi_time" jdbcType="TIMESTAMP" property="hiTime" />
    <result column="ok_time_s" jdbcType="TIMESTAMP" property="okTimeS" />
    <result column="flag" jdbcType="TINYINT" property="flag" />
    <result column="ok_time_t" jdbcType="TIMESTAMP" property="okTimeT" />
    <result column="ok_time_p" jdbcType="TIMESTAMP" property="okTimeP" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    result_id, student_id, parent_id, teacher_id, lo_time, hi_time, ok_time_s, flag, 
    ok_time_t, ok_time_p
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from examdo_mental_health
    where result_id = #{resultId,jdbcType=BIGINT}
  </select>
  <select id="queryExamdoMhForTeacherByPage" resultType="com.njpes.www.entity.scaletoollib.ExamdoStudent">
      select es.id resultid,es.taskid,esmh.scaleid_t scaleid,es.user_id userid,esmh.ok_time_t oktime,es.studentvisible,es.teachervisible,es.parentvisible,es.statusflag,s.sfzjh,
      s.xbm,sc.title scalename,sc.questionnum, gc.title njmc,es.nj,es.bj,c.bjmc,s.xm 
      from examdo_student es
        join examdo_mental_health esmh on es.id=esmh.result_id 
        join student s on es.user_id = s.id 
		join class c on es.bj = c.id 
		join scale sc on sc.code= esmh.scaleid_t
		join gradecode gc on gc.id = es.gradeid
		where 
	    es.orgid=#{dmgFilterParam.orgid}
		and esmh.teacher_id=#{dmgFilterParam.threeAngleUserId}
		<if test="dmgFilterParam.name != null and dmgFilterParam.name!=''" >
		    and s.xm = #{dmgFilterParam.name}
		</if>
		<if test="dmgFilterParam.gender != null and dmgFilterParam.gender != '-1'.toString()" >
		    and s.xbm = #{dmgFilterParam.gender}
		</if>
		and  CURRENT_TIMESTAMP BETWEEN es.lo_time and es.hi_time
		Order By es.lo_time Desc
  </select>
  <select id="queryExamdoMhForParentByPage" resultType="com.njpes.www.entity.scaletoollib.ExamdoStudent">
      select es.id resultid,es.taskid,esmh.scaleid_p scaleid,es.user_id userid,esmh.ok_time_p oktime,es.studentvisible,es.teachervisible,es.parentvisible,es.statusflag,s.sfzjh,
      s.xbm,sc.title scalename,sc.questionnum, gc.title njmc,es.nj,es.bj,c.bjmc,s.xm 
      from examdo_student es
        join examdo_mental_health esmh on es.id=esmh.result_id 
        join student s on es.user_id = s.id 
		join class c on es.bj = c.id 
		join scale sc on sc.code= es.scale_id
		join gradecode gc on gc.id = es.gradeid
		where 
		 es.orgid=#{dmgFilterParam.orgid}
		and esmh.parent_id=#{dmgFilterParam.threeAngleUserId}
		<if test="dmgFilterParam.name != null and dmgFilterParam.name!=''" >
		    and s.xm = #{dmgFilterParam.name}
		</if>
		<if test="dmgFilterParam.gender != null and dmgFilterParam.gender != '-1'.toString()" >
		    and s.xbm = #{dmgFilterParam.gender}
		</if>
		and CURRENT_TIMESTAMP BETWEEN es.lo_time and es.hi_time
		Order By es.lo_time Desc
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    delete from examdo_mental_health
    where taskid = #{taskid,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.njpes.www.entity.assessmentcenter.ExamdoMentalHealth">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    insert into examdo_mental_health (result_id, student_id, parent_id, 
      teacher_id, lo_time, hi_time, 
      ok_time_s, flag, ok_time_t, 
      ok_time_p)
    values (#{resultId,jdbcType=BIGINT}, #{studentId,jdbcType=BIGINT}, #{parentId,jdbcType=BIGINT}, 
      #{teacherId,jdbcType=BIGINT}, #{loTime,jdbcType=TIMESTAMP}, #{hiTime,jdbcType=TIMESTAMP}, 
      #{okTimeS,jdbcType=TIMESTAMP}, #{flag,jdbcType=TINYINT}, #{okTimeT,jdbcType=TIMESTAMP}, 
      #{okTimeP,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.njpes.www.entity.assessmentcenter.ExamdoMentalHealth">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    insert into examdo_mental_health
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="resultId != null">
        result_id,
      </if>
      <if test="studentId != null">
        student_id,
      </if>
      <if test="parentId != null">
        parent_id,
      </if>
      <if test="teacherId != null">
        teacher_id,
      </if>
      <if test="loTime != null">
        lo_time,
      </if>
      <if test="hiTime != null">
        hi_time,
      </if>
      <if test="okTimeS != null">
        ok_time_s,
      </if>
      <if test="flag != null">
        flag,
      </if>
      <if test="okTimeT != null">
        ok_time_t,
      </if>
      <if test="okTimeP != null">
        ok_time_p,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="resultId != null">
        #{resultId,jdbcType=BIGINT},
      </if>
      <if test="studentId != null">
        #{studentId,jdbcType=BIGINT},
      </if>
      <if test="parentId != null">
        #{parentId,jdbcType=BIGINT},
      </if>
      <if test="teacherId != null">
        #{teacherId,jdbcType=BIGINT},
      </if>
      <if test="loTime != null">
        #{loTime,jdbcType=TIMESTAMP},
      </if>
      <if test="hiTime != null">
        #{hiTime,jdbcType=TIMESTAMP},
      </if>
      <if test="okTimeS != null">
        #{okTimeS,jdbcType=TIMESTAMP},
      </if>
      <if test="flag != null">
        #{flag,jdbcType=TINYINT},
      </if>
      <if test="okTimeT != null">
        #{okTimeT,jdbcType=TIMESTAMP},
      </if>
      <if test="okTimeP != null">
        #{okTimeP,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.njpes.www.entity.assessmentcenter.ExamdoMentalHealth">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    update examdo_mental_health
    <set>
      <if test="studentId != null">
        student_id = #{studentId,jdbcType=BIGINT},
      </if>
      <if test="parentId != null">
        parent_id = #{parentId,jdbcType=BIGINT},
      </if>
      <if test="teacherId != null">
        teacher_id = #{teacherId,jdbcType=BIGINT},
      </if>
      <if test="loTime != null">
        lo_time = #{loTime,jdbcType=TIMESTAMP},
      </if>
      <if test="hiTime != null">
        hi_time = #{hiTime,jdbcType=TIMESTAMP},
      </if>
      <if test="okTimeS != null">
        ok_time_s = #{okTimeS,jdbcType=TIMESTAMP},
      </if>
      <if test="flag != null">
        flag = #{flag,jdbcType=TINYINT},
      </if>
      <if test="okTimeT != null">
        ok_time_t = #{okTimeT,jdbcType=TIMESTAMP},
      </if>
      <if test="okTimeP != null">
        ok_time_p = #{okTimeP,jdbcType=TIMESTAMP},
      </if>
    </set>
    where result_id = #{resultId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.njpes.www.entity.assessmentcenter.ExamdoMentalHealth">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Feb 01 18:19:06 CST 2016.
    -->
    update examdo_mental_health
    set student_id = #{studentId,jdbcType=BIGINT},
      parent_id = #{parentId,jdbcType=BIGINT},
      teacher_id = #{teacherId,jdbcType=BIGINT},
      lo_time = #{loTime,jdbcType=TIMESTAMP},
      hi_time = #{hiTime,jdbcType=TIMESTAMP},
      ok_time_s = #{okTimeS,jdbcType=TIMESTAMP},
      flag = #{flag,jdbcType=TINYINT},
      ok_time_t = #{okTimeT,jdbcType=TIMESTAMP},
      ok_time_p = #{okTimeP,jdbcType=TIMESTAMP}
    where result_id = #{resultId,jdbcType=BIGINT}
  </update>
  <update id="updateOkTimeForStudent">
       update examdo_mental_health set ok_time_s=#{okTimeS,jdbcType=TIMESTAMP} where result_id = #{resultId,jdbcType=BIGINT}
  </update>
  <update id="updateOkTimeForTeacher">
       update examdo_mental_health set ok_time_t=#{okTimeT,jdbcType=TIMESTAMP} where result_id = #{resultId,jdbcType=BIGINT}
  </update>
  <update id="updateOkTimeForParent">
       update examdo_mental_health set ok_time_p=#{okTimeP,jdbcType=TIMESTAMP} where result_id = #{resultId,jdbcType=BIGINT}
  </update>
</mapper>