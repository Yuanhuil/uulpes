<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.njpes.www.dao.workschedule.JobActivityRecordMapper">
  <resultMap id="BaseResultMap" type="com.njpes.www.entity.workschedule.JobActivityRecord">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jul 22 00:29:25 CST 2015.
    -->
    <result column="id" jdbcType="BIGINT" property="id" />
    <result column="tablename" jdbcType="VARCHAR" property="tablename" />
    <result column="starttime" jdbcType="TIMESTAMP" property="starttime" />
    <result column="endtime" jdbcType="TIMESTAMP" property="endtime" />
    <result column="activitycatalog" jdbcType="VARCHAR" property="activitycatalog" />
    <result column="activitytype" jdbcType="CHAR" property="activitytype" />
    <result column="dep" jdbcType="BIGINT" property="dep" />
    <result column="vip_event" jdbcType="CHAR" property="vipEvent" />
    <result column="joboverview" jdbcType="CHAR" property="joboverview" />
    <result column="author" jdbcType="BIGINT" property="author"/>
    <result column="schoolyear" jdbcType="VARCHAR" property="schoolyear"/>
    <result column="term" jdbcType="CHAR" property="term"/>
    <result column="depname" jdbcType="VARCHAR" property="depname"/>
  </resultMap>
  <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="com.njpes.www.entity.workschedule.JobActivityRecordWithBLOBs">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Jul 22 00:29:25 CST 2015.
    -->
    <result column="title" jdbcType="LONGVARCHAR" property="title" />
    <result column="content" jdbcType="LONGVARCHAR" property="content" />
  </resultMap>
  <sql id="Base_Column_List">
  	t.id,tablename,starttime,endtime,activitycatalog,activitytype,dep,author,schoolyear,term
  	</sql>
  <select id="selectAll" resultMap="ResultMapWithBLOBs">
  	select 
  	t.id,t.tablename,t.starttime,t.endtime,c.name as activitycatalog,ty.name as activitytype,t.dep,
  	 t.title, t.content,t.vip_event,t.joboverview,t.author
  	 from job_activityrecord t
  	left join dic_job_activity_catalog c on t.activitycatalog = c.id
  	left join dic_job_activity_type ty on t.activitytype = ty.id
  	<where>
  		<if test="params.activitycatalog != null and params.activitycatalog != ''">
  		 	and activitycatalog =  #{params.activitycatalog,jdbcType=VARCHAR}
  		</if>
  		<if test="params.activitytype != null and params.activitytype != ''">
  			and activitytype =  #{params.activitytype,jdbcType=VARCHAR}
  		</if>
  		<if test="params.dep!=null and params.dep>0"> 
  		    and t.dep = #{params.dep}
  		</if>
  		<if test="params.starttime != null">
  		<![CDATA[
  			and starttime >=#{params.starttime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  		<if test="params.endtime != null">
  		<![CDATA[
  			and endtime <=#{params.endtime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  	</where>
  </select>
  <select id="selectRecord" resultMap="ResultMapWithBLOBs">
  	select 
  	t.id,t.tablename,t.starttime,t.endtime,c.name as activitycatalog,ty.name as activitytype,t.dep,
  	 t.title, t.content,t.vip_event,t.joboverview,t.author
  	 from job_activityrecord t
  	left join dic_job_activity_catalog c on t.activitycatalog = c.id
  	left join dic_job_activity_type ty on t.activitytype = ty.id
  	<where>
  		<if test="id!=null">
  			and t.id=#{id,jdbcType=BIGINT}
  		</if>
  		<if test="tablename!=null">
  			and tablename=#{tablename,jdbcType=VARCHAR}
  		</if>
  	</where>
  </select>
  <select id="selectByPage" resultMap="ResultMapWithBLOBs">
  	select 
  	t.id,t.tablename,t.starttime,t.endtime,c.name as activitycatalog,ty.name as activitytype,t.dep,
  	 t.title, t.content,t.vip_event,t.joboverview,t.author
  	 from job_activityrecord t
  	left join dic_job_activity_catalog c on t.activitycatalog = c.id
  	left join dic_job_activity_type ty on t.activitytype = ty.id
  	<where>
  		<if test="params.activitycatalog != null and params.activitycatalog != ''">
  		 	and activitycatalog =  #{params.activitycatalog,jdbcType=VARCHAR}
  		</if>
  		<if test="params.activitytype != null and params.activitytype != ''">
  			and activitytype =  #{params.activitytype,jdbcType=VARCHAR}
  		</if>
  		<if test="params.starttime != null">
  		<![CDATA[
  			and starttime >=#{params.starttime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  		<if test="params.endtime != null">
  		<![CDATA[
  			and endtime <=#{params.endtime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  		<if test="params.vipEvent != null and params.vipEvent !='' and params.vipEvent == '1'.toString()">
  			and vip_event = #{params.vipEvent,jdbcType=VARCHAR}
  		</if>
  	</where>
  	order by starttime desc
  </select>
  <update id="updateField" statementType="STATEMENT">
  	update ${tablename} set ${field}=${fieldValue} where id=${recordId}
  </update>
  <select id="selectBySubOrgidsPage" resultMap="ResultMapWithBLOBs">
  	select 
  	t.id,t.tablename,t.starttime,t.endtime,c.name as activitycatalog,ty.name as activitytype,t.dep,
  	 t.title, t.content,t.vip_event,t.joboverview,t.author,org.name as depname
  	 from job_activityrecord t
  	left join dic_job_activity_catalog c on t.activitycatalog = c.id
  	left join dic_job_activity_type ty on t.activitytype = ty.id
  	left join organization org on org.id=t.dep
  	<where>
  		<if test="params.activitycatalog != null and params.activitycatalog != ''">
  		 	and activitycatalog =  #{params.activitycatalog,jdbcType=VARCHAR}
  		</if>
  		<if test="params.activitytype != null and params.activitytype != ''">
  			and activitytype =  #{params.activitytype,jdbcType=VARCHAR}
  		</if>
  		<if test="params.starttime != null">
  		<![CDATA[
  			and starttime >=#{params.starttime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  		<if test="params.endtime != null">
  		<![CDATA[
  			and endtime <=#{params.endtime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  		<if test="orgId!=null and orgId >0">
  			and org.parent_id = #{orgId,jdbcType=BIGINT}
  		</if>
  		<if test="params.vipEvent != null and params.vipEvent !='' and params.vipEvent == '1'.toString()">
  			and vip_event = #{params.vipEvent,jdbcType=VARCHAR}
  		</if>
  	</where>
  </select>
  <select id="selectByOrgidsPage" resultMap="ResultMapWithBLOBs">
  	select 
  	t.id,t.tablename,t.starttime,t.endtime,c.name as activitycatalog,ty.name as activitytype,t.dep,
  	 t.title, t.content,t.vip_event,t.joboverview,t.author,org.name as depname
  	 from job_activityrecord t
  	left join dic_job_activity_catalog c on t.activitycatalog = c.id
  	left join dic_job_activity_type ty on t.activitytype = ty.id
  	left join organization org on org.id=t.dep
  	<where>
  		<if test="params.activitycatalog != null and params.activitycatalog != ''">
  		 	and activitycatalog =  #{params.activitycatalog,jdbcType=VARCHAR}
  		</if>
  		<if test="params.activitytype != null and params.activitytype != ''">
  			and activitytype =  #{params.activitytype,jdbcType=VARCHAR}
  		</if>
  		<if test="params.starttime != null">
  		<![CDATA[
  			and starttime >=#{params.starttime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  		<if test="params.endtime != null">
  		<![CDATA[
  			and endtime <=#{params.endtime, jdbcType=TIMESTAMP}
  		]]>
  		</if>
  		<if test="orgId!=null and orgId >0">
  			and org.id = #{orgId,jdbcType=BIGINT}
  		</if>
  		<if test="params.vipEvent != null and params.vipEvent !='' and params.vipEvent == '1'.toString()">
  			and vip_event = #{params.vipEvent,jdbcType=VARCHAR}
  		</if>
  	</where>
  </select>
</mapper>